<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:SDAHymns.Desktop.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
        x:Class="SDAHymns.Desktop.Views.ProfileEditorWindow"
        x:DataType="vm:ProfileEditorViewModel"
        Title="Display Profile Editor"
        Width="1000" Height="700"
        Background="#0D0D0D">

    <Design.DataContext>
        <vm:ProfileEditorViewModel/>
    </Design.DataContext>

    <Grid ColumnDefinitions="280,*">
        <!-- Left Sidebar: Profile List -->
        <Border Grid.Column="0"
                Background="#1A1A1A"
                BorderBrush="#333333"
                BorderThickness="0,0,1,0">
            <Grid RowDefinitions="Auto,*,Auto">
                <!-- Header -->
                <Border Grid.Row="0"
                        Background="#0D0D0D"
                        BorderBrush="#333333"
                        BorderThickness="0,0,0,1"
                        Padding="20,15">
                    <TextBlock Text="Profiles"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="White"/>
                </Border>

                <!-- Profile List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ListBox ItemsSource="{Binding Profiles}"
                             SelectedItem="{Binding SelectedProfile}"
                             Background="Transparent"
                             BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="15,12"
                                        Background="Transparent">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Name}"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="White"/>
                                        <TextBlock Text="{Binding Description}"
                                                   FontSize="11"
                                                   Foreground="#888888"
                                                   TextWrapping="Wrap"
                                                   Margin="0,4,0,0"/>
                                        <TextBlock Text="(System Profile)"
                                                   FontSize="10"
                                                   Foreground="#666666"
                                                   Margin="0,4,0,0"
                                                   IsVisible="{Binding IsSystemProfile}"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </ScrollViewer>

                <!-- Action Buttons -->
                <Border Grid.Row="2"
                        Background="#0D0D0D"
                        BorderBrush="#333333"
                        BorderThickness="0,1,0,0"
                        Padding="15">
                    <StackPanel Spacing="8">
                        <Button Content="+ New Profile"
                                Command="{Binding CreateProfileCommand}"
                                HorizontalAlignment="Stretch"
                                Background="#0078D4"
                                Foreground="White"
                                Padding="12,8"/>
                        <Button Content="Duplicate"
                                Command="{Binding DuplicateProfileCommand}"
                                HorizontalAlignment="Stretch"
                                Background="#2A2A2A"
                                Foreground="White"
                                Padding="12,8"/>
                        <Button Content="Delete"
                                Command="{Binding DeleteProfileCommand}"
                                HorizontalAlignment="Stretch"
                                Background="#D32F2F"
                                Foreground="White"
                                Padding="12,8"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Right Panel: Profile Editor -->
        <Grid Grid.Column="1" RowDefinitions="*,Auto">
            <ScrollViewer Grid.Row="0"
                          VerticalScrollBarVisibility="Auto"
                          Padding="30,20">
                <StackPanel Spacing="25"
                            IsEnabled="{Binding SelectedProfile, Converter={x:Static ObjectConverters.IsNotNull}}">

                    <!-- Profile Info Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Profile Information"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Profile Name" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Text="{Binding SelectedProfile.Name}"
                                     Watermark="Enter profile name..."
                                     Background="#2A2A2A"
                                     Foreground="White"
                                     BorderBrush="#444444"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Description" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Text="{Binding SelectedProfile.Description}"
                                     Watermark="Enter description..."
                                     Background="#2A2A2A"
                                     Foreground="White"
                                     BorderBrush="#444444"
                                     AcceptsReturn="True"
                                     TextWrapping="Wrap"
                                     Height="60"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Typography Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Typography"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Font Family" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox SelectedItem="{Binding SelectedProfile.FontFamily}"
                                      Background="#2A2A2A"
                                      Foreground="White"
                                      BorderBrush="#444444">
                                <ComboBoxItem Content="Inter"/>
                                <ComboBoxItem Content="Arial"/>
                                <ComboBoxItem Content="Georgia"/>
                                <ComboBoxItem Content="Times New Roman"/>
                                <ComboBoxItem Content="Verdana"/>
                                <ComboBoxItem Content="Calibri"/>
                                <ComboBoxItem Content="Segoe UI"/>
                            </ComboBox>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Title Size" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Verse Size" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBlock Grid.Column="4" Grid.Row="0" Text="Label Size" FontSize="12" Foreground="#CCCCCC"/>

                            <NumericUpDown Grid.Column="0" Grid.Row="1"
                                          Value="{Binding SelectedProfile.TitleFontSize}"
                                          Minimum="12"
                                          Maximum="100"
                                          Increment="2"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.VerseFontSize}"
                                          Minimum="12"
                                          Maximum="120"
                                          Increment="2"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                            <NumericUpDown Grid.Column="4" Grid.Row="1"
                                          Value="{Binding SelectedProfile.LabelFontSize}"
                                          Minimum="12"
                                          Maximum="80"
                                          Increment="2"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </Grid>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Font Weight" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox SelectedItem="{Binding SelectedProfile.FontWeight}"
                                      Background="#2A2A2A"
                                      Foreground="White"
                                      BorderBrush="#444444">
                                <ComboBoxItem Content="Normal"/>
                                <ComboBoxItem Content="SemiBold"/>
                                <ComboBoxItem Content="Bold"/>
                            </ComboBox>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Line Height" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Letter Spacing" FontSize="12" Foreground="#CCCCCC"/>

                            <NumericUpDown Grid.Column="0" Grid.Row="1"
                                          Value="{Binding SelectedProfile.LineHeight}"
                                          Minimum="1.0"
                                          Maximum="3.0"
                                          Increment="0.1"
                                          FormatString="F1"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.LetterSpacing}"
                                          Minimum="-5"
                                          Maximum="10"
                                          Increment="0.5"
                                          FormatString="F1"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </Grid>
                    </StackPanel>

                    <!-- Colors Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Colors"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" RowSpacing="8">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Background Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="0" Grid.Row="1"
                                    Text="{Binding SelectedProfile.BackgroundColor}"
                                    Watermark="#000000"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Text Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="2" Grid.Row="1"
                                    Text="{Binding SelectedProfile.TextColor}"
                                    Watermark="#FFFFFF"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="0" Grid.Row="2" Text="Title Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="0" Grid.Row="3"
                                    Text="{Binding SelectedProfile.TitleColor}"
                                    Watermark="#FFFFFF"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="2" Grid.Row="2" Text="Label Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="2" Grid.Row="3"
                                    Text="{Binding SelectedProfile.LabelColor}"
                                    Watermark="#CCCCCC"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="0" Grid.Row="4" Text="Accent Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="0" Grid.Row="5"
                                    Text="{Binding SelectedProfile.AccentColor}"
                                    Watermark="#0078D4"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>
                        </Grid>
                    </StackPanel>

                    <!-- Background Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Background"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Background Opacity" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Value="{Binding SelectedProfile.BackgroundOpacity}"
                                          Minimum="0"
                                          Maximum="1"
                                          Increment="0.1"
                                          FormatString="F1"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </StackPanel>

                        <CheckBox Content="Transparent Background (for OBS)"
                                 IsChecked="{Binding SelectedProfile.TransparentBackground}"
                                 Foreground="White"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Background Image Path (Optional)" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Text="{Binding SelectedProfile.BackgroundImagePath}"
                                    Watermark="Path to background image..."
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Image Mode" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox Grid.Column="0" Grid.Row="1"
                                     SelectedItem="{Binding SelectedProfile.BackgroundImageMode}"
                                     Background="#2A2A2A"
                                     Foreground="White"
                                     BorderBrush="#444444">
                                <ComboBoxItem Content="Fill"/>
                                <ComboBoxItem Content="Fit"/>
                                <ComboBoxItem Content="Stretch"/>
                                <ComboBoxItem Content="Tile"/>
                            </ComboBox>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Image Opacity" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.BackgroundImageOpacity}"
                                          Minimum="0"
                                          Maximum="1"
                                          Increment="0.1"
                                          FormatString="F1"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </Grid>
                    </StackPanel>

                    <!-- Layout Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Layout"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Text Alignment" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox Grid.Column="0" Grid.Row="1"
                                     SelectedItem="{Binding SelectedProfile.TextAlignment}"
                                     Background="#2A2A2A"
                                     Foreground="White"
                                     BorderBrush="#444444">
                                <ComboBoxItem Content="Left"/>
                                <ComboBoxItem Content="Center"/>
                                <ComboBoxItem Content="Right"/>
                            </ComboBox>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Vertical Alignment" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox Grid.Column="2" Grid.Row="1"
                                     SelectedItem="{Binding SelectedProfile.VerticalAlignment}"
                                     Background="#2A2A2A"
                                     Foreground="White"
                                     BorderBrush="#444444">
                                <ComboBoxItem Content="Top"/>
                                <ComboBoxItem Content="Center"/>
                                <ComboBoxItem Content="Bottom"/>
                            </ComboBox>
                        </Grid>

                        <TextBlock Text="Margins (pixels)"
                                   FontSize="14"
                                   Foreground="#CCCCCC"
                                   Margin="0,8,0,0"/>
                        <Grid ColumnDefinitions="*,5,*,5,*,5,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Left" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="0" Grid.Row="1"
                                          Value="{Binding SelectedProfile.MarginLeft}"
                                          Minimum="0"
                                          Maximum="500"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Right" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.MarginRight}"
                                          Minimum="0"
                                          Maximum="500"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>

                            <TextBlock Grid.Column="4" Grid.Row="0" Text="Top" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="4" Grid.Row="1"
                                          Value="{Binding SelectedProfile.MarginTop}"
                                          Minimum="0"
                                          Maximum="300"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>

                            <TextBlock Grid.Column="6" Grid.Row="0" Text="Bottom" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="6" Grid.Row="1"
                                          Value="{Binding SelectedProfile.MarginBottom}"
                                          Minimum="0"
                                          Maximum="300"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </Grid>
                    </StackPanel>

                    <!-- Effects Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Effects"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <CheckBox Content="Enable Text Shadow"
                                 IsChecked="{Binding SelectedProfile.EnableTextShadow}"
                                 Foreground="White"/>

                        <StackPanel Spacing="10"
                                   IsEnabled="{Binding SelectedProfile.EnableTextShadow}">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Shadow Color" FontSize="12" Foreground="#CCCCCC"/>
                                <TextBox Text="{Binding SelectedProfile.ShadowColor}"
                                        Watermark="#000000"
                                        Background="#2A2A2A"
                                        Foreground="White"
                                        BorderBrush="#444444"/>
                            </StackPanel>

                            <Grid ColumnDefinitions="*,5,*,5,*" RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Column="0" Grid.Row="0" Text="Blur Radius" FontSize="12" Foreground="#CCCCCC"/>
                                <NumericUpDown Grid.Column="0" Grid.Row="1"
                                              Value="{Binding SelectedProfile.ShadowBlurRadius}"
                                              Minimum="0"
                                              Maximum="50"
                                              Increment="1"
                                              Background="#2A2A2A"
                                              Foreground="White"
                                              BorderBrush="#444444"/>

                                <TextBlock Grid.Column="2" Grid.Row="0" Text="Offset X" FontSize="12" Foreground="#CCCCCC"/>
                                <NumericUpDown Grid.Column="2" Grid.Row="1"
                                              Value="{Binding SelectedProfile.ShadowOffsetX}"
                                              Minimum="-20"
                                              Maximum="20"
                                              Increment="1"
                                              Background="#2A2A2A"
                                              Foreground="White"
                                              BorderBrush="#444444"/>

                                <TextBlock Grid.Column="4" Grid.Row="0" Text="Offset Y" FontSize="12" Foreground="#CCCCCC"/>
                                <NumericUpDown Grid.Column="4" Grid.Row="1"
                                              Value="{Binding SelectedProfile.ShadowOffsetY}"
                                              Minimum="-20"
                                              Maximum="20"
                                              Increment="1"
                                              Background="#2A2A2A"
                                              Foreground="White"
                                              BorderBrush="#444444"/>
                            </Grid>
                        </StackPanel>

                        <CheckBox Content="Enable Text Outline"
                                 IsChecked="{Binding SelectedProfile.EnableTextOutline}"
                                 Foreground="White"
                                 Margin="0,10,0,0"/>

                        <StackPanel Spacing="10"
                                   IsEnabled="{Binding SelectedProfile.EnableTextOutline}">
                            <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                                <TextBlock Grid.Column="0" Grid.Row="0" Text="Outline Color" FontSize="12" Foreground="#CCCCCC"/>
                                <TextBox Grid.Column="0" Grid.Row="1"
                                        Text="{Binding SelectedProfile.OutlineColor}"
                                        Watermark="#000000"
                                        Background="#2A2A2A"
                                        Foreground="White"
                                        BorderBrush="#444444"/>

                                <TextBlock Grid.Column="2" Grid.Row="0" Text="Thickness" FontSize="12" Foreground="#CCCCCC"/>
                                <NumericUpDown Grid.Column="2" Grid.Row="1"
                                              Value="{Binding SelectedProfile.OutlineThickness}"
                                              Minimum="1"
                                              Maximum="10"
                                              Increment="1"
                                              Background="#2A2A2A"
                                              Foreground="White"
                                              BorderBrush="#444444"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>

                    <!-- Enhanced Slide Formatting (Spec 018) -->

                    <!-- Verse Number Styling Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Verse Number Styling"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Verse Number Style" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox SelectedItem="{Binding SelectedProfile.VerseNumberStyle}"
                                      Background="#2A2A2A"
                                      Foreground="White"
                                      BorderBrush="#444444">
                                <ComboBoxItem Content="None"/>
                                <ComboBoxItem Content="InlinePlain"/>
                                <ComboBoxItem Content="InlineBold"/>
                                <ComboBoxItem Content="Badge"/>
                                <ComboBoxItem Content="LargeDecorative"/>
                                <ComboBoxItem Content="Superscript"/>
                            </ComboBox>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Verse Number Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="0" Grid.Row="1"
                                    Text="{Binding SelectedProfile.VerseNumberColor}"
                                    Watermark="#CCCCCC"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Number Size" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.VerseNumberSize}"
                                          Minimum="12"
                                          Maximum="80"
                                          Increment="2"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>
                        </Grid>

                        <CheckBox Content="Verse Number on Separate Line"
                                 IsChecked="{Binding SelectedProfile.VerseNumberSeparateLine}"
                                 Foreground="White"/>
                    </StackPanel>

                    <!-- Chorus Formatting Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Chorus Formatting"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Chorus Style" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox SelectedItem="{Binding SelectedProfile.ChorusStyle}"
                                      Background="#2A2A2A"
                                      Foreground="White"
                                      BorderBrush="#444444">
                                <ComboBoxItem Content="SameAsVerse"/>
                                <ComboBoxItem Content="Indented"/>
                                <ComboBoxItem Content="Italic"/>
                                <ComboBoxItem Content="ColoredText"/>
                                <ComboBoxItem Content="BackgroundHighlight"/>
                                <ComboBoxItem Content="Combined"/>
                            </ComboBox>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Indent Amount" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="0" Grid.Row="1"
                                          Value="{Binding SelectedProfile.ChorusIndentAmount}"
                                          Minimum="0"
                                          Maximum="200"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"/>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Text Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="2" Grid.Row="1"
                                    Text="{Binding SelectedProfile.ChorusTextColor}"
                                    Watermark="#E0E0E0"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>

                            <TextBlock Grid.Column="4" Grid.Row="0" Text="Background Color" FontSize="12" Foreground="#CCCCCC"/>
                            <TextBox Grid.Column="4" Grid.Row="1"
                                    Text="{Binding SelectedProfile.ChorusBackgroundColor}"
                                    Watermark="#1A1A1A"
                                    Background="#2A2A2A"
                                    Foreground="White"
                                    BorderBrush="#444444"/>
                        </Grid>

                        <CheckBox Content="Chorus in Italic"
                                 IsChecked="{Binding SelectedProfile.ChorusItalic}"
                                 Foreground="White"/>
                        <CheckBox Content="Show 'Refrain:' Label"
                                 IsChecked="{Binding SelectedProfile.ShowChorusLabel}"
                                 Foreground="White"/>
                    </StackPanel>

                    <!-- Slide Settings Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Slide Settings"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <CheckBox Content="Show Title Only on First Verse"
                                 IsChecked="{Binding SelectedProfile.ShowTitleOnFirstVerseOnly}"
                                 Foreground="White"
                                 ToolTip.Tip="When enabled, hymn title appears only when hymn first loads"/>

                        <CheckBox Content="Enable Black Ending Slide"
                                 IsChecked="{Binding SelectedProfile.EnableBlackEndingSlide}"
                                 Foreground="White"
                                 ToolTip.Tip="Show black slide after last verse (like PowerPoint)"/>

                        <StackPanel Spacing="4"
                                   IsEnabled="{Binding SelectedProfile.EnableBlackEndingSlide}">
                            <TextBlock Text="Auto-Close Duration (seconds)" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Value="{Binding SelectedProfile.EndingSlideAutoCloseDuration}"
                                          Minimum="0"
                                          Maximum="60"
                                          Increment="1"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"
                                          ToolTip.Tip="0 = disabled, auto-close after N seconds"/>
                        </StackPanel>

                        <Grid ColumnDefinitions="*,10,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Paragraph Spacing" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="0" Grid.Row="1"
                                          Value="{Binding SelectedProfile.ParagraphSpacing}"
                                          Minimum="0"
                                          Maximum="100"
                                          Increment="5"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"
                                          ToolTip.Tip="Space between verse number and text"/>

                            <TextBlock Grid.Column="2" Grid.Row="0" Text="Verse Spacing" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Grid.Column="2" Grid.Row="1"
                                          Value="{Binding SelectedProfile.VerseSpacing}"
                                          Minimum="0"
                                          Maximum="150"
                                          Increment="10"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"
                                          ToolTip.Tip="Space between verses (future use)"/>
                        </Grid>
                    </StackPanel>

                    <!-- Transitions Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Transitions"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Verse Transition Effect" FontSize="12" Foreground="#CCCCCC"/>
                            <ComboBox SelectedItem="{Binding SelectedProfile.VerseTransition}"
                                      Background="#2A2A2A"
                                      Foreground="White"
                                      BorderBrush="#444444">
                                <ComboBoxItem Content="None"/>
                                <ComboBoxItem Content="Fade"/>
                                <ComboBoxItem Content="Slide"/>
                                <ComboBoxItem Content="Dissolve"/>
                                <ComboBoxItem Content="FadeToBlack"/>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Transition Duration (ms)" FontSize="12" Foreground="#CCCCCC"/>
                            <NumericUpDown Value="{Binding SelectedProfile.TransitionDuration}"
                                          Minimum="100"
                                          Maximum="1000"
                                          Increment="50"
                                          Background="#2A2A2A"
                                          Foreground="White"
                                          BorderBrush="#444444"
                                          ToolTip.Tip="Duration of transition animation"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Advanced Section -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Advanced"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                        <Separator Background="#333333"/>

                        <CheckBox Content="Show Verse Numbers"
                                 IsChecked="{Binding SelectedProfile.ShowVerseNumbers}"
                                 Foreground="White"/>
                        <CheckBox Content="Show Hymn Title"
                                 IsChecked="{Binding SelectedProfile.ShowHymnTitle}"
                                 Foreground="White"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- Bottom Action Bar -->
            <Border Grid.Row="1"
                    Background="#1A1A1A"
                    BorderBrush="#333333"
                    BorderThickness="0,1,0,0"
                    Padding="30,15">
                <Grid ColumnDefinitions="*,Auto">
                    <!-- Status Message -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding StatusMessage}"
                               VerticalAlignment="Center"
                               Foreground="#888888"
                               FontSize="12"/>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1"
                               Orientation="Horizontal"
                               Spacing="10">
                        <Button Content="Export"
                                Click="ExportButton_Click"
                                Background="#2A2A2A"
                                Foreground="White"
                                Padding="20,10"
                                BorderBrush="#444444"/>
                        <Button Content="Import"
                                Command="{Binding ImportProfileCommand}"
                                Background="#2A2A2A"
                                Foreground="White"
                                Padding="20,10"
                                BorderBrush="#444444"/>
                        <Button Content="Reset"
                                Command="{Binding ResetProfileCommand}"
                                Background="#2A2A2A"
                                Foreground="White"
                                Padding="20,10"
                                BorderBrush="#444444"/>
                        <Button Content="Preview"
                                Command="{Binding PreviewProfileCommand}"
                                Background="#0078D4"
                                Foreground="White"
                                Padding="20,10"/>
                        <Button Content="Save Changes"
                                Command="{Binding SaveProfileCommand}"
                                Background="#2E7D32"
                                Foreground="White"
                                Padding="20,10"
                                FontWeight="Bold"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
